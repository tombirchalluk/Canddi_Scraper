function ukPhones(knwl) {

    this.languages = {
	 english: true
    };

    /**
    * Used to print the number in a specific format. Taking from the original Phones plugin.
    */

    function formatPhoneNumber(strNumber){

        var strFormattedNumber = strNumber.slice(strNumber.length - 7, strNumber.length - 4) + " " +
        strNumber.slice(strNumber.length - 4, strNumber.length);
    
        strFormattedNumber = " " + strNumber.slice(strNumber.length - (10), strNumber.length - 7) + " " +
        strFormattedNumber;
    
        if (strNumber.length > (10)) {
            strFormattedNumber = strNumber.slice(0, strNumber.length - (10)) +
            "" + strFormattedNumber;
        }

        return strFormattedNumber;
    };

    this.calls = function() {

        var arrResults = [];
                
        var words = knwl.words.get('words');
        var strCurrWord = null;

        var regexPlusFour = /^(\+?44|0)$/;  // Regex for either +44, or 0 at the start of our string
        var regexThreeNums = /\d{3}$/;      // Regex for the 3 numbers in the middle of the number e.g. +44 161 414 1080
        var regexFourNums = /^\d{4}$/;      // Regex for the last 4 numbers

        for (var i = 0; i < words.length; i++) {

            strCurrWord = knwl.tasks.removeCharacters(["-", "(", ")"], words[i]);
                    
            if (regexFourNums.test(strCurrWord)) {  // if the current word matches the last four numbers regex.
                if (i > 0 && strCurrWord.length === 4) {    // if the last part of the number contains four digits.
                            
                    var strMiddleThreeNums = knwl.tasks.removeCharacters(["(", ")"], words[i-1]);  // remove any brackets that could be in the number

                    if (regexThreeNums.test(strMiddleThreeNums)) { // if the middle 3 numbers match the regex
                        strCurrWord = strMiddleThreeNums + strCurrWord;  // add the last four numbers to these 3.
                    } 

                    var strThreeNums = knwl.tasks.removeCharacters(["(", ")"], words[i-2]);    // move back down the output of words.  

                    if (regexThreeNums.test(strThreeNums)) {    // if the remaing middle three numbers match the regex
                        strCurrWord = strThreeNums + strCurrWord;  // add this to our number
                    } 

                    var strPlusFourFour = knwl.tasks.removeCharacters(["(", ")"], words[i-3]);  // move back down to the remaining numbers

                    if(regexPlusFour.test(strPlusFourFour)) {   // if the input matches the regex, either +44, or 0.
                        strCurrWord = strPlusFourFour + strCurrWord;    // add this to the numbers we have.
                    }

                    if (strCurrWord.length >= 11 ) {    // if there's enough numbers to make it a valid phone number
                        var phoneObj = {
                            ukPhones: formatPhoneNumber(strCurrWord)  // format the number and make it accessible in the object.
                        };

                        arrResults.push(phoneObj); // push the results.
                    }
                }     
            } 
        }
                return arrResults;
    };
            var ukPhones = this;
};

module.exports = ukPhones;
